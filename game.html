<html>
  <head>
    <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
	<script src="https://code.createjs.com/1.0.0/soundjs.min.js"></script>
    <script> 
	
	var relations = {'ball': ['sphere', 'toy', 'throw', 'game equipment'], 'marble': ['rock', 'ball', 'stone'], 'goal': ['end', 'score', 'game equipment'], 'net': ['internet', 'game equipment', 'trap', 'goal'], 'target': ['end', 'sport equipment', 'victim', 'reference', 'place', 'spot', 'goal'], 'purpose': ['end', 'resolution', 'resolve', 'goal'], 'intention': ['end', 'goal'], 'aim': ['end', 'direction', 'way', 'goal'], 'intent': ['end', 'signification', 'significance', 'meaning', 'goal'], 'destination': ['end', 'terminal', 'direction', 'goal'], 'basket': ['container', 'score', 'goal'], 'objective': ['end', 'goal'], 'cage': ['net', 'constraint', 'restraint', 'enclosure'], 'fishnet': ['net'], 'shoe': ['footwear'], 'calceus': ['shoe'], 'sneaker': ['shoe'], 'walker': ['shoe', 'traveler'], 'sandal': ['shoe'], 'footwear': ['wearable', 'clothing', 'wear'], 'boot': ['footwear', 'case', 'shell', 'compartment'], 'overshoe': ['footwear'], 'game equipment': ['equipment'], 'counter': ['game equipment'], 'point': ['end', 'target', 'aim', 'objective', 'score'], 'clothing': ['covering'], 'neckpice': ['clothing'], 'uniform': ['clothing'], 'dress': ['clothing'], 'outwear': ['wearable', 'clothing', 'wear'], 'handwear': ['wearable', 'clothing', 'wear'], 'attire': ['wearable', 'clothing', 'wear'], 'clothes': ['clothing'], 'geaddress': ['clothing'], 'accessory': ['wearable', 'clothing', 'wear'], 'score': ['music', 'number', 'rating', 'evaluation'], 'match': ['duplicate', 'competition', 'counterpart', 'contest', 'score', 'lighter'], 'grade': ['slope', 'rank', 'rating', 'evaluation', 'score'], 'wearable': ['covering'], 'headdress': ['wearable', 'wear'], 'neckpiece': ['wearable', 'wear'], 'will': ['intention', 'intent', 'purpose', 'aim'], 'mind': ['intention', 'intent', 'purpose', 'aim'], 'idea': ['intention', 'intent', 'purpose', 'aim'], 'sake': ['intention', 'intent', 'purpose', 'aim'], 'wear': ['covering'], 'internet': [''], 'business': ['aim', 'objective'], 'track': ['aim'], 'marcher': ['walker'], 'strider': ['walker'], 'hiker': ['walker'], 'passerby': ['walker'], 'parader': ['walker'], 'perseverance': ['purpose'], 'persistence': ['purpose'], 'tenacity': ['purpose'], 'diligence': ['purpose'], 'trap': ['device', 'hazard', 'plan'], 'pitfall': ['trap'], 'pit': ['trap'], 'entaglement': ['trap'], 'web': ['trap'], 'resolution': ['trait', 'papers'], 'decision': ['resolution'], 'determination': ['resolution'], 'stiffness': ['resolution'], 'willpower': ['resolution'], 'end': ['content', 'boundary', 'state', 'bound', 'place', 'sopt'], 'itention': ['end'], 'endpoint': ['end'], 'pole': ['end'], 'entdgame': ['end'], 'termination': ['end'], 'rise': ['grade'], 'upgrade': ['grade'], 'belt': ['accessory'], 'evaluation': ['judgment', 'assessment'], 'marking': ['evaluation'], 'rock': ['crystal']}

	class TreeNode {
		constructor(value) {
		this.value = value;
		this.descendants = [];
		}
	}
	var dataTree = new TreeNode("root");
	dataTree.descendants.push(new TreeNode("lostandfound"));
	var historial = "Welcome to Mauri's game\nGGJ21\n\n";
	var historial = " _____                            _    _      _\n|  ___|                          | |  | |    (_)\n| |__  __   __  ___  _ __  _   _ | |_ | |__   _  _ __    __ _\n|  __| \\ \\ / / / _ \\| '__|| | | || __|| '_ \\ | || '_ \\  / _` |\n| |___  \\ V / |  __/| |   | |_| || |_ | | | || || | | || (_| |\n\\____/   \\_/   \\___||_|    \\__, | \\__||_| |_||_||_| |_| \\__, |\n                            __/ |                        __/ |\n                           |___/                        |___/\n          _                      _              _\n         (_)                    | |            | |\n          _  ___                | |  ___   ___ | |_\n         | |/ __|               | | / _ \\ / __|| __|\n         | |\\__ \\               | || (_) |\\__ \\| |_\n         |_||___/               |_| \\___/ |___/ \\__|\n\n\n                                /              _            \\\n                               (  _ __  _|   _|_ _    __  _| )\n                                \\(_|| |(_|    | (_)|_|| |(_|/\n\nLAF (Lost And Found) console 1.0.0\nType 'help' for more information.\n\n";
	var linea = ">";
	var path ="root/";
	var isLSAvailable = false;
	var isCDAvailable = false;
	var isMVAvailable = false;
	var isPointsAvailable = false;
	var text = new createjs.Text(historial + path + linea, "20px Courier New", "#00ff00");
	text.lineHeight = 20
	var stage;// = new createjs.Stage("demoCanvas");
	
    function init() {
		stage = new createjs.Stage("demoCanvas");
		stage.addChild(text)
        stage.update();
    }
	
	function fidnNodeInDataTree(pathToCheck, structure)
	{   if (pathToCheck.slice(0,-1) == structure.value.toLowerCase())
		{
			return structure;
		}
		else
		{
			var firstFolder = pathToCheck.slice(0,pathToCheck.indexOf("/"));
			for(var i = 0; i < structure.descendants.length; i++)
			{
				if (firstFolder == structure.descendants[i])
				{
					return fidnNodeInDataTree(pathToCheck.slice(pathToCheck.indexOf("/") + 1), structure.descendants[i]);
				}
			}
			return 0;
		}
	}
	
	function printFoldersAtLocation()
	{
		var currentLocation = fidnNodeInDataTree(path, dataTree);
		if (currentLocation != 0)
		{
			currentLocation.descendants.forEach(element =>historial = historial + element.value + " ");
			historial = historial + "\n";
		}
	}
	function parseCommand(commandLine) {
		var command = (commandLine.includes(" ")) ? commandLine.substr(0, commandLine.indexOf(" ")) : commandLine;
		var args = commandLine.substr(commandLine.indexOf(" "));
		if (command === ">help")
		{
			// shows available commands
			historial = historial + "\nhelp\t\tDisplays this message\nls\t\t\t\tList information about the FILEs in the current directory\n";
			if (isCDAvailable)
			{
				historial = historial + "cd concats param path to current path. If param is .. it goes back one level if possible path\n";
			}
			if (isMVAvailable)
			{
				historial = historial + "mv moves folder param1 to param2\n";
			}
			if (isPointsAvailable)
			{
				historial = historial + "points shows points\n";
			}
			
			historial = historial + "\n";
			
			isLSAvailable = true;
		}
		else if (command === ">cd" && isCDAvailable)
		{
			// todo validate valid path
			isMVAvailable = true;
			path = path + args.slice(1) + "/";
		}
		else if (command === ">ls" && isLSAvailable)
		{
			isCDAvailable = true;
			printFoldersAtLocation();
		}
		else if (command === ">mv" && isMVAvailable) 
		{
			isPointsAvailable = true;
			alert("mv " + args);
		}
		else if (command == ">points" && isPointsAvailable)
		{
			var currentPoints = 0; //GetPoints();
			historial = historial + "Current Points " + currentPoints + "\n";
		}
		else
		{
			historial = historial + "Unknown command\n\n";
		}
	}

	document.onkeyup = function(e) {
	  if(window.event) { // IE                  
		keynum = e.keyCode;
	  } else if(e.which){ // Netscape/Firefox/Opera                 
		keynum = e.which;
	  }
	  if (keynum === 8)
	  {
			linea = linea.slice(0,-1);
	  }
	  else if(keynum === 13)
	  {
			historial = historial + linea + "\n";
			parseCommand(linea);
			linea = ">";
	  }
	  else
	  {
		  linea  = linea + String.fromCharCode(keynum).toLowerCase();
	  }
	  text.text(historial + path + linea)
	  stage.clear();
	  stage.addChild(text);
	  stage.update();
	}
    </script>
	
	
  </head>
  <body onload="init();"  id="char" bgcolor=black>
    <canvas id="demoCanvas" width="800" height="600"></canvas>
  </body>
</html>
